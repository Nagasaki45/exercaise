import{f as I,a as v,c as z,t as J}from"../chunks/DJS9wBG_.js";import{i as Ce}from"../chunks/CWFtMCaS.js";import{o as Ee,a as Ve}from"../chunks/YGWwcCV1.js";import{h as le,S as Pe,ao as Y,ap as qe,ah as P,T as De,d as e,q as S,U as W,R as f,V as y,X as w,Y as U,a4 as L,aq as ce}from"../chunks/D3NXlZUO.js";import{s as q,e as ue}from"../chunks/tj3d_5tf.js";import{i as A}from"../chunks/Cp66WgFm.js";import{s as Ue,a as fe}from"../chunks/h4zghCTB.js";import{p as Ge}from"../chunks/DhtkPJSp.js";import{w as Oe}from"../chunks/BfrWKG2O.js";import{g as K}from"../chunks/BVkLACo8.js";const pe=[...` 	
\r\fÂ \v\uFEFF`];function Ye(o,k,d){var a=""+o;if(d){for(var s in d)if(d[s])a=a?a+" "+s:s;else if(a.length)for(var c=s.length,t=0;(t=a.indexOf(s,t))>=0;){var i=t+c;(t===0||pe.includes(a[t-1]))&&(i===a.length||pe.includes(a[i]))?a=(t===0?"":a.substring(0,t))+a.substring(i+1):t=i}}return a===""?null:a}function Be(o,k,d,a,s,c){var t=o.__className;if(le||t!==d||t===void 0){var i=Ye(d,a,c);(!le||i!==o.getAttribute("class"))&&(i==null?o.removeAttribute("class"):o.className=i),o.__className=d}else if(c&&s!==c)for(var _ in c){var R=!!c[_];(s==null||R!==!!s[_])&&o.classList.toggle(_,R)}return c}function Q(o){return typeof o=="number"?o:typeof o=="string"?parseInt(o,10):0}function Fe(o){const k=[],d=a=>{const s=a.sets||1,c=Q(a.rest);for(let t=0;t<s;t++)k.push({name:a.name,type:a.type,amount:a.type==="time"?Q(a.amount):a.amount,notes:a.notes}),c>0&&t<s-1&&k.push({name:"Rest",type:"time",amount:c,notes:`Rest after set ${t+1} of ${a.name}`})};if(o.exercises)for(const a of o.exercises)d(a);else if(o.rounds)for(let a=0;a<o.rounds.length;a++){const s=o.rounds[a],c=Q(s.rest_after_round);for(let t=0;t<s.count;t++){for(const R of s.exercises)d(R);const i=t===s.count-1,_=a===o.rounds.length-1;c>0&&(!i||!_)&&k.push({name:"Round Rest",type:"time",amount:c,notes:`Rest after round ${t+1}`})}}return k}var He=I('<p class="svelte-1l4ap58">Loading workout...</p>'),Me=I('<h1 class="workout-complete svelte-1l4ap58">Workout Complete! ðŸŽ‰</h1> <button class="main-control svelte-1l4ap58">Go Home</button>',1),Xe=I('<p class="svelte-1l4ap58"> </p>'),je=I('<div class="timer-display svelte-1l4ap58"> </div>'),ze=I('<div class="reps-display svelte-1l4ap58"> </div>'),Je=I('<h2 class="svelte-1l4ap58"> </h2> <h1 class="svelte-1l4ap58"> </h1> <!> <!> <button><!></button>',1),Ke=I('<div class="next-up-banner svelte-1l4ap58"><span class="svelte-1l4ap58">Next up</span> <strong class="svelte-1l4ap58"> </strong></div>'),Qe=I('<div class="container svelte-1l4ap58"><!></div> <!>',1);function ct(o,k){Pe(k,!1);const d=()=>fe(Ge,"$page",s),a=()=>fe(Oe,"$workouts",s),[s,c]=Ue(),t=S(),i=S(),_=S(),R=S();let p=S([]),b=S(0),g=S(0),G,x=S(!0),N=null,h=null;function ve(){if(!h)return;const n=h.currentTime,r=h.createGain();r.connect(h.destination),r.gain.setValueAtTime(.5,n),r.gain.exponentialRampToValueAtTime(.001,n+1);const m=h.createOscillator();m.connect(r),m.type="sawtooth",m.frequency.setValueAtTime(523.25,n),m.start(n),m.stop(n+1)}function me(){const n=e(i)?`Next up: ${e(i).name}`:"You did it!",r=new SpeechSynthesisUtterance(n);speechSynthesis.speak(r)}async function Z(){if("wakeLock"in navigator)try{N=await navigator.wakeLock.request("screen"),console.log("Screen Wake Lock activated."),N.addEventListener("release",()=>{console.log("Screen Wake Lock released automatically.")})}catch(n){console.error(`Failed to activate wake lock: ${n.name}, ${n.message}`)}else console.warn("Screen Wake Lock API not supported.")}function $(){N&&(N.release(),N=null,console.log("Screen Wake Lock released manually."))}function ee(){N!==null&&document.visibilityState==="visible"&&!e(x)&&Z()}Ee(()=>{const n=d().params.slug;if(!n){K("/");return}const r=decodeURIComponent(n),m=a().find(C=>C.name===r);m?(f(p,Fe(m)),e(p).length>0&&e(p)[0].type==="time"&&f(g,e(p)[0].amount)):K("/");try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}document.addEventListener("visibilitychange",ee),window.addEventListener("pagehide",$)});function te(){f(x,!1),Z(),e(g)<=0&&e(t).type==="time"&&f(g,e(t).amount),G=setInterval(()=>{ce(g,-1),e(t).type==="time"&&e(g)===5&&me(),e(g)<=0&&(ve(),ae())},1e3)}function ae(){clearInterval(G);const n=e(b)+1;if(n<e(p).length){f(b,n);const r=e(p)[n];r.type==="time"?(f(g,r.amount),te()):(f(x,!0),f(g,0),$())}else ce(b),f(x,!0),f(g,0),$()}function de(){if(e(t)){if(e(t).type==="reps"){ae();return}if(e(x)){if(!h)try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}te()}else f(x,!0),clearInterval(G),$()}}Ve(()=>{clearInterval(G),$(),document.removeEventListener("visibilitychange",ee),window.removeEventListener("pagehide",$),h&&h.close()}),Y(()=>(e(p),e(b)),()=>{f(t,e(p)[e(b)])}),Y(()=>(e(p),e(b)),()=>{f(i,e(p)[e(b)+1])}),Y(()=>(e(t),e(p)),()=>{f(_,e(t)===void 0&&e(p).length>0)}),Y(()=>(e(g),e(t)),()=>{f(R,e(g)>0?e(g):e(t)?.type==="time"?e(t).amount:0)}),qe(),Ce();var ne=Qe(),B=P(ne),ge=y(B);{var he=n=>{var r=He();v(n,r)},_e=n=>{var r=z(),m=P(r);{var C=E=>{var D=Me(),F=W(P(D),2);ue("click",F,()=>K("/")),v(E,D)},ke=E=>{var D=z(),F=P(D);{var be=H=>{var oe=Je(),M=P(oe),xe=y(M);w(M);var X=W(M,2),Se=y(X,!0);w(X);var se=W(X,2);{var Le=l=>{var u=Xe(),T=y(u,!0);w(u),U(()=>q(T,(e(t),L(()=>e(t).notes)))),v(l,u)};A(se,l=>{e(t),L(()=>e(t).notes)&&l(Le)})}var re=W(se,2);{var Ae=l=>{var u=je(),T=y(u);w(u),U(()=>q(T,`${e(R)??""}s`)),v(l,u)},Ie=l=>{var u=ze(),T=y(u);w(u),U(()=>q(T,`${e(t),L(()=>e(t).amount)??""} reps`)),v(l,u)};A(re,l=>{e(t),L(()=>e(t).type==="time")?l(Ae):l(Ie,!1)})}var O=W(re,2);let ie;var Re=y(O);{var Te=l=>{var u=J("Next");v(l,u)},We=l=>{var u=z(),T=P(u);{var Ne=V=>{var j=J("Start");v(V,j)},$e=V=>{var j=J("Pause");v(V,j)};A(T,V=>{e(x)?V(Ne):V($e,!1)},!0)}v(l,u)};A(Re,l=>{e(t),L(()=>e(t).type==="reps")?l(Te):l(We,!1)})}w(O),U(()=>{q(xe,`Step ${e(b)+1} of ${e(p),L(()=>e(p).length)??""}`),q(Se,(e(t),L(()=>e(t).name))),ie=Be(O,1,"main-control svelte-1l4ap58",null,ie,{pause:e(t).type==="time"&&!e(x)})}),ue("click",O,de),v(H,oe)};A(F,H=>{e(t)&&H(be)},!0)}v(E,D)};A(m,E=>{e(_)?E(C):E(ke,!1)},!0)}v(n,r)};A(ge,n=>{!e(t)&&!e(_)?n(he):n(_e,!1)})}w(B);var ye=W(B,2);{var we=n=>{var r=Ke(),m=W(y(r),2),C=y(m,!0);w(m),w(r),U(()=>q(C,(e(i),L(()=>e(i).name)))),v(n,r)};A(ye,n=>{e(i)&&n(we)})}v(o,ne),De(),c()}export{ct as component};
